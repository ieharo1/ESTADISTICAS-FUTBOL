<%- include('partials/header', { title }) %>

<div class="page-header">
  <div class="d-flex flex-column flex-lg-row gap-3 align-items-lg-center justify-content-between">
    <div>
      <h1>Vista por Equipo</h1>
      <p class="mb-0">An√°lisis detallado de rendimiento, rachas y estad√≠sticas avanzadas</p>
    </div>
    <div class="filter-bar p-0 bg-transparent border-0">
      <div class="form-group">
        <label class="form-label">Seleccionar Equipo</label>
        <select id="teamSelect" class="form-select">
          <% teams.forEach((team) => { %>
          <option value="<%= team._id %>"><%= team.name %> - <%= team.league %></option>
          <% }) %>
        </select>
      </div>
    </div>
  </div>
</div>

<div id="teamContent">
  <section class="row g-3 mb-4" id="teamMetrics">
    <div class="col-12 col-md-6 col-xl-3">
      <div class="metric-card info">
        <div class="metric-icon">‚öΩÔ∏è</div>
        <div class="metric-label">Goles Anotados</div>
        <div class="metric-value" id="goalsFor">-</div>
        <div class="metric-subtitle">goles a favor</div>
      </div>
    </div>
    <div class="col-12 col-md-6 col-xl-3">
      <div class="metric-card danger">
        <div class="metric-icon">üéØ</div>
        <div class="metric-label">Goles Recibidos</div>
        <div class="metric-value" id="goalsAgainst">-</div>
        <div class="metric-subtitle">goles en contra</div>
      </div>
    </div>
    <div class="col-12 col-md-6 col-xl-3">
      <div class="metric-card success">
        <div class="metric-icon">üìä</div>
        <div class="metric-label">Posesi√≥n Promedio</div>
        <div class="metric-value" id="possession">-</div>
        <div class="metric-subtitle">porcentaje</div>
      </div>
    </div>
    <div class="col-12 col-md-6 col-xl-3">
      <div class="metric-card warning">
        <div class="metric-icon">‚≠ê</div>
        <div class="metric-label">Efectividad</div>
        <div class="metric-value" id="efficiency">-</div>
        <div class="metric-subtitle">porcentaje</div>
      </div>
    </div>
  </section>

  <section class="row g-3 mb-4">
    <div class="col-12 col-lg-4">
      <div class="card h-100">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            Racha Reciente
          </h2>
        </div>
        <div class="card-body">
          <div id="formDisplay" class="d-flex flex-wrap gap-2 justify-content-center"></div>
          <div class="text-center mt-3">
            <span class="badge bg-success bg-opacity-10 text-success" id="formWins">0V</span>
            <span class="badge bg-secondary bg-opacity-10 text-secondary" id="formDraws">0E</span>
            <span class="badge bg-danger bg-opacity-10 text-danger" id="formLosses">0P</span>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-4">
      <div class="card h-100">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            Estad√≠sticas Clave
          </h2>
        </div>
        <div class="card-body">
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-number" id="shotsOnTarget">-</div>
              <div class="stat-label">Tiros al Arco</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="xg">-</div>
              <div class="stat-label">xG</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="defensiveIndex">-</div>
              <div class="stat-label">√çndice Def.</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="offensiveEfficiency">-</div>
              <div class="stat-label">Efic. Ofen.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-4">
      <div class="card h-100">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>
            Rendimiento General
          </h2>
        </div>
        <div class="card-body">
          <div id="gaugeChart" class="chart-box-sm"></div>
        </div>
      </div>
    </div>
  </section>

  <section class="row g-3 mb-4">
    <div class="col-12 col-lg-7">
      <div class="card h-100">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
            Evoluci√≥n del Rendimiento
          </h2>
        </div>
        <div class="card-body">
          <div id="trendChart" class="chart-box"></div>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-5">
      <div class="card h-100">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><rect x="7" y="7" width="3" height="9"/><rect x="14" y="7" width="3" height="5"/></svg>
            Mapa de Calor
          </h2>
        </div>
        <div class="card-body">
          <div id="heatmapChart" class="chart-box"></div>
        </div>
      </div>
    </div>
  </section>

  <section class="row g-3">
    <div class="col-12 col-lg-6">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M18 20V10"/><path d="M12 20V4"/><path d="M6 20v-6"/></svg>
            Goles vs Expected Goals
          </h2>
        </div>
        <div class="card-body">
          <div id="xgCompareChart" class="chart-box"></div>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-6">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
            Radar de Atributos
          </h2>
        </div>
        <div class="card-body">
          <div id="attributesRadar" class="chart-box"></div>
        </div>
      </div>
    </div>
  </section>
</div>

<script src="/js/team.js"></script>
<%- include('partials/footer') %>
