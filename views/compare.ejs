<%- include('partials/header', { title }) %>

<div class="page-header">
  <div class="d-flex flex-column flex-lg-row gap-3 align-items-lg-center justify-content-between">
    <div>
      <h1>Vista Comparativa</h1>
      <p class="mb-0">Compara múltiples equipos y analiza diferencias estratégicas</p>
    </div>
  </div>
</div>

<section class="card mb-4">
  <div class="card-header">
    <h2 class="card-title">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
      Seleccionar Equipos
    </h2>
  </div>
  <div class="card-body">
    <div class="row g-3 align-items-end">
      <div class="col-12 col-lg-8">
        <label class="form-label">Equipos (Ctrl/Cmd + Click para múltiples)</label>
        <select id="compareTeams" class="form-select" multiple size="6">
          <% teams.forEach((team) => { %>
          <option value="<%= team._id %>"><%= team.name %> - <%= team.league %></option>
          <% }) %>
        </select>
      </div>
      <div class="col-12 col-lg-4 d-grid">
        <button id="compareBtn" class="btn btn-primary">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
          Comparar Equipos
        </button>
      </div>
    </div>
  </div>
</section>

<div id="compareResults" style="display: none;">
  <section class="row g-3 mb-4">
    <div class="col-12 col-lg-6">
      <div class="card h-100">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>
            Radar Comparativo
          </h2>
        </div>
        <div class="card-body">
          <div id="advancedRadar" class="chart-box"></div>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-6">
      <div class="card h-100">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
            Goles y Efectividad
          </h2>
        </div>
        <div class="card-body">
          <div id="compareBar" class="chart-box"></div>
        </div>
      </div>
    </div>
  </section>

  <section class="row g-3 mb-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
            Comparación de xG por Liga
          </h2>
        </div>
        <div class="card-body">
          <div id="leagueLine" class="chart-box-lg"></div>
        </div>
      </div>
    </div>
  </section>

  <section class="row g-3">
    <div class="col-12 col-lg-6">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><circle cx="12" cy="12" r="10"/><path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"/><path d="M12 18V6"/></svg>
            Posesión vs Tiros
          </h2>
        </div>
        <div class="card-body">
          <div id="possessionScatter" class="chart-box"></div>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-6">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>
            Defensa vs Ataque
          </h2>
        </div>
        <div class="card-body">
          <div id="defenseAttack" class="chart-box"></div>
        </div>
      </div>
    </div>
  </section>
</div>

<script>
  window.__LEAGUES__ = <%- JSON.stringify(leagues) %>;
</script>
<script src="/js/compare.js"></script>
<%- include('partials/footer') %>
